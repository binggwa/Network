# 1. 계층화된 아키텍쳐 및 OSI 모델
***
### OSI 아키텍쳐 모델
- 서로 통신할 수 있는 컴퓨터 네트워크 설계를 위한 개방형 시스템 아키텍쳐로 개발
- 통신 프로세스를 7개의 계층으로 분할
  1. 물리 계층
  2. 데이터 링크 계층
  3. 네트워크 계층
  4. 전송 계층
  5. 세션 계층
  6. 프레젠테이션 계층
  7. 애플리케이션 계층
- 통신 최종 시스템을 위한 계층들
- 상위 4개 계층은 종단 간 통신(End to End)을 위한 것
- 네트워크 노드는 3개의 계층이 있다
- 네트워크와 데이터 링크 계층에는 단일 홉을 통한 P2P 프로세스 간의 상호작용이 포함
### 왜 아키텍쳐를 계층화하는가?
- 계층화 아키텍쳐는 통신 프로세스를 여러 부분으로 분할하여 네트워크의 설계, 구현, 테스트를 간소화함
- 각 계층의 프로토콜은 다른 계층의 프로토콜과 별도로 설계할 수 있다
- 프로토콜은 아래 계층의 서비스를 "call" 한다.
- 계층화는 아래 계층을 변경하지 않고도 프로토콜과 서비스를 수정하고 발전시킬 수 있는 유연성을 제공한다.
***
### 1. 물리 계층
- 통신 채널의 비트 전송을 처리
- 이 계층은 특정 시스템 매개변수 선택에 관심
- 기계적 측면뿐 아니라 연결을 설정하고 해제하는 절차와 관련
- 물리적인 측면에서의 정의와 구현
  - 기계적 : 케이플, 플러그, 핀
  - 전기/광학적 : 모듈화, 신호 강도, 전압 수준, bit times,
  - 기능적 : 어떻게 작동하는지, 유지보수하는지, 물리적 링크를 비활성화하는지 등
- 이더넷, DSL, 케이블 모뎀, 전화 모뎀 등
### 2. 데이터 링크 계층
- 노드에 직접 연결되는 전송 링크를 통해 프레임이라는 정보 블록을 전송하는 역할
- 전송된 비트 시퀀스에 프레이밍 정보를 삽입하여 프레임의 경계를 표시
- 이를 프레임으로 그룹화하는 방법, 디지털 전송 중 큰 오류를 감지하는 방법, 오류 감지를 위해 체크된 비트를 계산하는 방법에 대해 다룬다
- 삽입물을 삽입하면 헤더에는 주소 정보를 표시하고, 트레일러에는 체크 비트를 표시하여 전송 오류를 복구
- 링크에는 근거리 통신망과 같은 방송 매체에 여러 노드가 연결된 경우가 포함
- 따라서 방송 매체에 대한 액세스를 조정하려면 미디어 액세스 제어 절차가 필요
- 수신 노드에서 버퍼 오버플로우를 방지하는 **_노드 간 흐름 제어를 수행_**
### 3. 네트워크 계층
- 통신 네트워크, 다중 네트워크를 통한 패킷 전송을 제공
- **매우 많은 네트워크 사용자를 수용할 수 있도록 주소 지정을 확장할 수 있어야 함**
- **네트워크 코드가 라우팅 알고리즘을 공동으로 실행하여 네트워크 전체의 라우팅 경로를 결정**한다
- 라우팅 프로토콜이란 네트워크를 통해 경로를 선택하는 절차를 의미
- 이 함수가 네트워크 계층을 참조 모델에서 가장 복잡하게 만든다
- 패킷 투 트래픽이 일시적으로 급증하는 것을 처리하기 위한 혼잡 제어 역할도 담당
### Internetworking
- 두 호스트가 서로 다른 두 네트워크에 연결되어 있는 경우 내부 라우팅 및 주소 체계가 다를 수 있는 둘 이상의 네트워크를 통해 데이터를 전송해야 한다.
- 인터네트워킹은 중간 네트워크에 연결된 게이트웨이 라우터 간에 패키지를 전송하는 네트워크 계층의 일부
- 한 호스트가 이더넷 LAN에 연결될 수 있는 시나리오에서, ATM 네트워크가 게이트웨이 라우터를 연결할 수 있다.
### 4. 전송 계층
- 소스 시스템의 프로세스에서 대상 시스템의 프로세스로 메시지를 종단 간 전송하는 역할
- 상위 계층에서 메시지를 수신하고 최종 컴퓨터 간 전송을 위해 **_세그먼트 또는 데이터그램_**이라는 정보 블록을 준비
- 다양한 서비스 제공
  - 시퀀스 바이트 또는 메시지를 오류 없이 안정적으로 전송하는 서비스
  - 빠르고 간단하게 메시지를 전송할 수 있는 비연결 서비스를 제공
### 5. 세션 계층, 6. 프레젠테이션 계층
- 비현실적
- 애플리케이션 계층에 통합되어 서로 다른 기능으로 정의됨
### 7. 애플리케이션 계층
- HTTP 프로토콜, DNS, 파일 전송, 이메일 및 기타 애플리케이션과 같이 통신과 관련된 애플리케이션에 자주 필요한 서비스를 제공
***
## 요약
- 하나 이상의 네트워크에 연결된 둘 이상의 시스템 간의 전체 통신 프로세스는 매우 복잡함
- 계층화는 관련 통신 기능을 관리 가능한 그룹으로 나눈다
***
# 2. 프로토콜 및 서비스에 대한 OSI Unified View
- OSI 참조 모델은 계층, 프로토콜, 서비스에 대한 통합 뷰를 개발하는데 기여
- 네트워크 아키텍쳐의 여러 계층에서도 비슷한 요구 사항이 발생
- 계층 : 함께 관리하고 그룹화할 수 있는 관련 통신 기능 집합
- 한 시스템의 계층 n은 다른 시스템의 계층 n과 상호 작용하여 상위 계층 n+1에 서비스를 제공
- 서로 다른 시스템의 해당 계층을 구성하는 개체를 **_"피어 프로세스"_**라고 함
- 계층 n의 프로세스를 계층 n **_엔티티_** 라고 함
- 동일한 레이어에 있는 시스템은 레이어 n 프로토콜이라는 정확한 규칙 세트를 사용함
- 레이어 n 피어 프로세스는 PDU(Protocol Data Unit)라는 프로토콜 데이터 단위를 교환하여 통신
### OSI Unified View : Services
- 피어 프로세스 간의 통신은 가상, 실제로는 간접적
- 계층 n+1은 계층 n에서 제공하는 서비스를 호출하여 정보를 전송
- 서비스는 서비스 액세스 포인트에서 사용가능
- 각 계층은 물리적 계층에 도달하여 전송이 이루어질 때까지 데이터와 제어 정보를 하위 계층으로 전달
- 아래 계층으로 전달되는 데이터를 SDU(Service Data Unit) 이라고 함
- SDU는 PDU에 캡슐화된다
### Encapsulation
- 위 레이어의 SDU가 PDU에 Payload로 캠슐화되면, 헤더가 추가되고, 경우에 따라 트레일러가 추가된다
- 헤더에는 주소와 같은 정보가 들어있다
- 트레일러에는 오류 제어를 위한 CRC와 같은 검사 비트가 포함된다
- 계층화 아키텍쳐에서 각 계층은 정보블록에 헤더와 CRC 체크섬 트레일러를 추가할 수 있다
- 프로토콜 헤더에는 주소, 시퀀스 번호, 플래그 비트, 길이 등과 같은 정보가 들어있다
- 목적지에서 각 레이어는 해당 헤더에 도달하여 취해야 할 조치를 결정하고 헤더와 트레일러를 제거한 후 결국 정보블록을 위 레이어로 전달
- 애플리케이션 계층에서 애플리케이션 데이터 블록을 전송할 때 실제로 데이터 링크 계층은 응용 프로그램 데이터 외에 여러 개의 헤더를 전송하고
- 가능하면 하나의 CRC 체크섬 트레일러를 전송해야 한다
### TCP/IP에서의 캡슐화
- HTTP 요청은 TCP 계층, 더 나아가 IP 계층, 마지막으로 물리적 네트워크 (ex) 이더넷) 에서 캡슐화
- 헤더 3개와 체크 비트 트레일러 1개가 HTTP 요청 자체에 추가
### Segmentation & Reassembly
- 레이어는 구현, 기타 이유로 전송가능 데이터블록의 크기를 제한할 수 있다
- 계층 n SDU는 속도가 느린 계층에서 단일 단위로 처리하기에는 너무 길 수 있다.
- 발신자 측에서는 SDU가 여러 PDU로 분할된다.
- 수신기 측에서는 PDU 시퀀스에 맞게 SDU를 재조립한다.
### Connectionless & Connection-Oriented Services
- 계층에서 제공하는 통신 서비스는 연결 지향형 or 비연결형
- 연결 지향 서비스
  - 세가지 페이즈
    - 연결 설정
    - SDU 전송
    - 연결 해제
- 비연결 서비스
  - 각 SDU가 직접 전송되므로 연결 설정이 필요하지 않음
### Internetworking
- 네트워크 또는 인터넷 네트워크를 구축하는 것
- 여러 개의 공존하는 서로 다른 네트워크 기술을 통해 작동
- IP 패킷 전송을 통해 유비쿼터스 연결을 제공
- 범용 통신 서비스를 제공하면서 대규모 경제성을 달성
### Internet Protocol (IP) Approach
- 인터넷을 하나로 묶는 것을 IP라고 함
- IP 패킷은 인터넷을 통해 정보를 전송
- 각 라우터의 IP 계층은 다음 라우터를 결정함
- 네트워크 인터페이스는 네트워크를 통해 IP 패킷을 전송
***
### 요약
- Unified View를 통해 여러 계층에 있는 프로토콜과 서비스에 대한 공통적인 이해
***
# 3. TCP/IP 아키텍쳐 및 라우팅 예시
### TCP/IP Protocol Suite
- 애플리케이션 계층은 HTTP, 웹 브라우징, 이메일, DNS, 실시간 전송 등 서비스 제공
- 전송 계층은 IP를 기반으로 두 개의 프로토콜을 제공하여 프로세스 간 통신을 가능하게 함
- TCP는 안정적인 스트림 서비스를 제공
- UDP는 최선의 사용자 데이터그램 서비스를 제공
- HTTP 및 SMTP 와 같은 애플리케이션 계층 프로토콜은 TCP를 통해 작동
- DNS 및 RTP 와 같은 애플리케이션 계층 프로토콜은 UDP를 통해 작동
- TCP와 UDP 모두 인터넷 라우팅 프로토콜인 IP를 통해 작동
- 이렇게 함으로써 연결이 필요 없는 패킷 전송을 최대한 활용할 수 있음
- 모든 상위 계층 프로토콜은 IP를 통해 네트워크 인터페이스에 액세스\
### Internet Protocol (IP)
- IP 계층은 라우터를 사용하여 여러 네트워크를 통한 정보 전송을 처리
- 단일 서비스를 제공하며, 연결이 필요 없는 패킷 전송을 최대한 활용
- 오류 복구, 흐름 제어를 위한 메커니즘을 제공하지 않음
### Internet Addresses
- 인터넷의 각 호스트는 전 세계적으로 고유한 IP 주소로 식별됨
- 라우터는 둘 이상의 물리적 네트워크에 연결되어 있으며, 각 네트워크 인터페이스에는 고유한 IP 주소가 할당됨
- 확장성을 위해 인터넷 주소는 네트워크 ID와 네트워크 내의 호스트 ID로 구성된 계층적인 주소다
- IP 패킷은 해당 네트워크 ID에 따라 라우팅된다
### Physical Addresses
- LAN에서 네트워크 인터페이스 카드는 물리적 주소로 식별됨
- 네트워크는 자체 주소를 사용하여 패킷이나 프레임을 적절한 대상으로 전송함
- 각 IP 네트워크 인터페이스에서 ARP(address resolution protocol)라는 주소 확인 프로토콜을 사용하여 IP 주소를 실제 주소로 해석해야 함
- 이더넷은 48비트 주소를 사용함
- 각 네트워크 인터페이스 카드에는 전 세계적으로 고유한 물리적 MAC 주소가 있음
***
### 워크스테이션에서 서버로 IP 패킷을 보내려고 하는 경우 가정
- 워크스테이션의 IP 패킷에는 IP 주소가 있고, IP 패킷 헤더에는 서버 IP 주소가 있다.
- 워크스테이션의 IP 엔티티는 라우팅 테이블을 살펴본 결과, 서버가 물리적 주소 s 를 사용하여 동일한 네트워크에 직접 연결되어 있음을 확인
- 주소가 w와 s인 이더넷 프레임에 캡슐화된 IP 패킷.
- 헤더에는 IP에 해당하는 값으로 설정된 프로토콜 유형 필드도 포함되어 있다.
- 그러면 이더넷 프레임이 LAN을 통해 브로드캐스트 된다.
- 서버의 네트워크 인터페이스 카드는 프레임이 호스트를 위한 것임을 인식, 프레임을 캡처하여 검사한다.
- 프로토콜 유형 필드가 IP로 설정되어 있음을 확인
- IP 패킷을 IP 엔티티에 전달
- 워크스테이션에서 서버로의 전달 완료
### 서버가 PC로 IP 패킷을 보내려고 하는 경우 가정
- PC는 PPP를 데이터 링크 제어로 실행하는 point-to-point 링크를 통해 라우터에 연결됨
- 링크 양쪽의 IP 주소는 링크가 설정될 때 setup
- 서버의 IP 테이블에는 대상이 서버의 LAN에 없으므로 패킷을 기본 라우터로 보내면 안된다는 내용이 나와있음
- 따라서 IP 패킷은 소스 주소 s 및 대상 주소 r로 캡슐화된다.
- 이더넷 프레임은 서버의 네트워크 인터페이스 카드에 의해 브로드캐스트되고
- 라우터의 네트워크 인터페이스 카드에 의해 캡처된다.
- 라우터의 네트워크 인터페이스 카드는 프로토콜 유형 필드를 검사하여 해당 IP 레이어에 패킷을 전달
- IP 계층은 IP 패킷 대상 주소를 검사하여 IP 패킷을 네트워크 주소 2,2로 라우팅해야 한다고 결정
- 라우터 표에는 2,2가 PPP 링크를 통해 직접 연결되어 있다고 나와있음
- 그다음 IP 패킷이 PPP 프레임에 캡슐화되어 PC로 전달됨
- PC 시험 프로토콜 유형 필드에서의 PPP, IP 레이어에 패킷을 전달함
- 라우팅 완료
***
### 요약
- 캡슐화는 계층화의 핵심
- 계층은 라우팅을 위해 함께 동작함