# 1. 브리지 및 데이터 링크 레이어 스위칭
***
### Interconnecting Networks
- 여러 네트워크를 상호 연결하는 방법
  - 둘 이상의 네트워크가 물리 계층 아래에 상호 연결된 경우 장치 유형을 리피터, 허브라고 함
  - 데이터 링크 계층에 연결되는 경우, 브리지
  - 네트워크 계층에서 연결되는 경우, 라우터
  - 전송, 애플리케이션 계층에서 연결되는 경우, 게이트웨이
### Hubs, Bridges & Routers
- 범위, 확장이 상호 연결의 유일한 문제인 경우 두 스테이션 사이의 최대 거리를 초과하지 않는 한, 리피터가 문제를 해결할 수 있음
- 허브는 이더넷 근거리 통신망에서 가장 단순한 리피터
- 리피터로 연결된 LAN의 충돌 도메인은 전체 네트워크이므로 모든 트래픽이 두 네트워크에 모두 나타남
- LAN이 MAC 주소 필터링을 사용하여 브리지에 연결된 경우 로컬 트래픽은 로컬 LAN에 유지됨
### General Bridge Issues
- 일반적으로 데이터 링크 계층에서 작동하는 브리지는 여러 네트워크 계층과 함께 작동할 수 있음
- 브리지는 한 이더넷과 다른 토큰 링을 연결함
- MAC 형식, 최대 프레임 길이, 버퍼링, 타이머 및 보안 요구 사항의 차이를 처리하려면 브리지가 필요함
### Bridges of Same Type
- 브리지는 동일한 유형의 LAN을 상호 연결하여 프레임 필터링 기능을 제공함
- 브리지는 각 프레임의 MAC 주소를 모니터링해야 함
- transparent(투명), 소스 라우팅 브리지 2가지의 유형이 널리 사용됨
- 투명 브리지는 일반적으로 이더넷에서 사용
- 소스 라우팅 브리지는 일반적으로 토큰 링 및 FTTI 네트워크에서 사용
### Transparent Bridges
- backward learning(역방향 학습)을 기반으로 룩업 테이블을 생성함
- 룩업 테이블은 각 스테이션을 포트 번호와 연결
- 브리지는 도착 프레임의 소스 주소를 관찰
- 소스와 대상이 동일한 LAN에 있는 경우 프레임이 삭제됨
- 소스와 대상이 서로 다른 LAN에 있는 경우 프레임을 전달
- 목적지를 알 수 없는 경우, flooding 사용
### S1 -> S5
- 테이블이 비어있을 때 3개의 LAN이 2개의 브리지로 상호 연결되는 예
- 스테이션 S1이 스테이션 S5로 프레임을 보냄
- 프레임은 S5의 MAC 주소를 대상 주소로, S1의 MAC를 소스 주소로 전달한다고 가정
- 브리지 B1이 프레임을 수신하면 빈 테이블을 찾아 하나의 소스 주소로 추가함. 이 번호가 프레임이 도착한 포트 번호
- 대상 주소가 테이블에 없기 때문에 프레임은 포트 2로 전달되고 LAN2에서 전송됨
- 브리지 B2는 소스 주소를 룩업 테이블에 추가하고 해당 프레임을 LAN3으로 전달하는 동일한 프로세스를 수행함
- S5가 프레임 수신, 두 브리지 모두 역방향 학습과정을 통해 S1의 위치를 학습함
### S3 -> S2
- 다음 스테이션 S3는 스테이션 S2에 프레임을 전송
- 브리지 B1과 B2 모두 프레임을 수신하여 동일한 LAN에 연결되어 있는지 확인함
- B1은 조회 테이블에서 주소 S3를 찾을 수 없으므로 포트2를 테이블에 추가함
- 그런 다음 프레임을 포트1으로 전달함, 포트1은 S2가 최종적으로 수신함
- 브리지 B2도 소스 주소를 찾지 못함
- 테이블에 새 정보를 추가하고 LAN3에 프레임을 전달함, 포워딩 낭비
### S4 -> S3
- 브리지 B2는 S4의 주소와 프레임이 도착한 포트 번호를 기록함
- 테이블에 S4의 레코드가 없으므로 B2는 포워딩 테이블에서 프레임의 스테이션 주소를 확인함
- 항목 중 하나와 일치하므로 브리지는 엔트리에 표시된 포트1으로 프레임을 전달함
- 브리지 B1이 프레임을 수신하면 소스 주소를 추가하고, 프레임이 테이블에 도착하는 포트 번호가 표시됨
- 브리지는 엔트리의 포트 번호가 프레임이 도착한 위치와 동일하기 때문에 목적지 주소를 찾음
- 프레임은 삭제되고 다른 프레임은 LAN1으로 전송
- 트래픽은 LAN2와 LAN3에만 제한됨
### S2 -> S1
- 브리지 B1이 먼저 포워딩 테이블에 S2의 주소를 추가한다고 가정
- 브리지가 S1의 주소를 알아내야 하는 경우 S1이 이미 동일한 포트에 연결되어 있다는 것을 확인한 후 프레임을 버림
- 즉, 트래픽은 LAN1에서 완전히 격리됨
- 이 경우 프레임이 LAN2로 전송되지 않기 때문에 브리지 B2가 S2의 주소를 인식할 수 없다는 점에 유의
### 요약
- 정적 네트워크에서 테이블은 결국 모든 스테이션 주소와 학습 중지를 저장함
- 스테이션은 항상 추가되고 이동한다
- 적응형 학습은 각 항목을 에이징하고 주기적으로 다시 학습하도록 하는 타이머를 도입
- 상호 연결된 네트워크에 루프가 없는 한 학습 프로세스는 정상적으로 작동함
- 네트워크에서 루프를 제거하기 위해 Spanning tree algorithm이라는 접근 방식을 지정함
***
# 2. 네트워크 레이어 서비스 및 토폴로지
***
### 네트워크 계층
- 네트워킹 아키텍처에서 가장 복잡한 계층
- 네트워크의 핵심은 네트워크에 연결된 사용자 간에 정보를 전송하는 것
- 매우 큰 규모를 처리할 수 있어야 함
- 정보를 어디로 보내야 하는가?
- 정보를 얻기 위해 어떤 경로를 사용해야 하는가?
### Packet Switching
- 네트워크 계층에서 정보는 데이터 패킷의 페이로드로 전송됨
- 패킷은 가능한 여러 경로를 거칠 수 있으므로 임의의 지연이 발생할 수 있으며 중간 지점에서의 버퍼 오버플로우로 인해 손실이 발생가능
- 애플리케이션 관점에서 보면 애플리케이션마다 정보 전송에 대한 요구 사항이 다름
### Network Service
- 전송 계층 프로토콜은 end-to-end로 작동하지만, 네트워크 계층은 hop-by-hop으로 작동함
- 네트워크 계층은 최선의 노력 or 지연 보장을 통해 연결 지향, 비연결 방식으로 전송 계층에 다양한 서비스 제공 가능
### Network Service vs. Operation
- 네트워크 계층은 연결 지향 또는 비연결 서비스를 제공하는 반면 기본 내부 네트워크는 IP와 같은 비연결 작업과 ATM과 같은 연결 지향 서비스를 제공
- 네트워크에서 패킷이 데이터그램으로 전송되고 각 패킷이 독립적으로 라우팅되는 경우 네트워크 내부 작동은 연결이 필요 없는 것으로 보임
- 비연결 작업을 통한 연결 지향 서비스도 가능
### Complexity at the Edge or in the Core?
- 네트워크 계층은 네트워크 사용자에게 다양한 서비스 중 선택가능한 옵션 제공가능
- 모든 서비스를 제공해야 하는것은 아님
- 네트워크 서비스 세트를 최소한으로 유지하는 데 2가지 이유가 있음
  - 네트워크 확장성에 대한 필요성에 대한 end-to-end Argument
### The End-to-End Argument for System Design
- 서비스는 모든 중간 구성 요소가 제대로 작동해야 하고 제대로 작동하려면 상위 수준을 배치해야 하므로
- end-to-end 함수는 하위 수준보다 상위 수준에서 구현하는 것이 가장 좋다는 주장
- 네트워크의 핵심을 단순하게 유지하고 엣지에 복잡성을 추가하면 성능과 확장성이 향상됨
### Network Layer Functions
- 필수 네트워크 기능은 패킷 라우팅, 포워딩 및 스케쥴링
- 라우팅
  - 네트워크 요소의 협업이 필요한 패킷을 라우팅하기 위한 최적의 경로 세트를 결정하는 메커니즘을 제공함
- 포워딩
  - 네트워크 요소 입력에서 출력으로 패킷을 전송하는 것
- 스케쥴링
  - 각 네트워크 요소의 패킷 전송 순서를 결정하는 것
- 선택적 기능
  - 혼잡 제어, 세그멘테이션 & 재조립, 보안 등
### End-to-End Packet Network Topology
- 패킷 네트워크에서는 개별 패킷 스트림이 폭주
  - 통계 멀티플렉싱은 스트림을 집중시키는 데 사용됨
- 인터넷 구조는 고도로 분산되어 있기 때문에 패킷이 통과하는 경로는 여러 조직에서 제어하는 여러 네트워크를 통과할 수 있음
### Access Multiplexing
- 액세스 및 멀티플렉서의 주요 목적은 개별 컴퓨터에서 일반적으로 폭주하는 트래픽 흐름을 집계된 흐름으로 결합하여 패킷 네트워크로의 전송 라인을 보다 효율적으로 사용하도록 하는 것
### Oversubscription
- 멀티플렉싱에서 일반적으로 사용되는 기법
- 멀티플렉서에 C bps 를 가진 n명의 가입자가 있다고 가정
- 각 가입자의 트래픽이 폭주하므로 각 가입자가 항상 활성 상태인 것은 아님
- 오버서브스크립션은 멀티플렉서와 패킷 네트워크 사이의 더 작은 대역폭 링크를 제공
- 모든 스테이션이 최대 속도로 모든 데이터를 전송하는 경우 오버플로가 발생할 수도 있음
### Oversubscription Ratio
- 연구에 따르면 멀티플렉싱 규모에 따라 실현 가능한 oversubscription 비율이 증가하는 것으로 나타남
- 멀티플렉싱의 좋은 예는 홈 네트워크 라우터 (Home LANs)
### LAN Concentration
- 근거리 통신망 허브와 액세스 네트워크에서도 스위치와 라우터로 흐르는 패킷 스트림을 집계함
### Campus Network
- 캠퍼스 네트워크의 일반적인 토폴로지
- 캠퍼스 네트워크의 라우터는 Autonomous System이라는 도메인을 형성 가능
- 도메인이라는 용어는 라우터가 동일한 라우팅 프로토콜을 실행한다는 것을 나타냄
- 도메인 내 라우팅과 도메인 간 라우팅에 대해 알아볼 것
### 요약
- end-to-end argument가 성능 및 확장성 측면에서 네트워킹 시스템 설계에 상당한 영향을 미침
- 오버서브스크립션은 효율성을 높이기 위해 멀티플렉싱하는 일반적인 기법임
***
# 3. 패킷 스위칭 : 데이터그램
***
### The Switching Function
- 패킷 스위칭 네트워크는 소스를 대상에 동적으로 상호 연결할 수 있도록 함
- 일반적으로 리소스는 필요할 때만 정보 흐름에 할당되므로 많은 사용자가 공유, 효율성이 높고 비용이 절감
### Packet Switchinig Network
- 패킷 스위칭 네트워크를 통해 정보를 전송하는 데에는 두가지 기본 접근 방식 존재
  - 연결지향 모드
    - 정보를 전송하기 전에 네트워크를 통해 가상 회로 연결을 설정하는 것이 포함됨
  - 무연결 모드
    - 연결 설정을 필요로 하지 않음
    - 대신 패킷이 목적지에 도착할 때까지 노드 간에 독립적으로 라우팅됨
- 두 접근 방식 모두 패킷 스위치를 사용하여 네트워크를 통해 패킷을 전달하는 것
### Message Switching
- 메시지 스위치는 일반적으로 저장 및 전달 방식으로 작동함
- 스위치에서 메시지를 완전히 수신해야 다음 스위치로 전달할 수 있음
- 전체 지연에는 전송 지연, 전파 지연이 있음을 유의
- 전송 회선이 공유되므로 메시지는 이전에 대기열에 있던 메시지가 전송될 때까지 기다려야 할 수도 있는데, 이를 대기열 지연이라 함
### Message Switching Delay
- 2개의 중간 스위치가 포함된 일시중지 상태에서 메시지를 전송할 때 발생하는 최소 지연을 보여줌
- 각 링크마다 타우 전파 시간이 있다고 가정
- 전송에는 총 3개의 홉이 걸리기 때문에 총 3개의 타우가 있다
- T를 각 링크 메시지 전송 시간으로 설정
- 저장 및 전달을 기준으로 3개의 T가 존재
- 메시지 종료를 위한 최소 지연은 3타우 + 3T 가 된다
- 이 지연에는 대기열 지연 및 오류 검사 지연이 고려되지 않음
### Long Message vs. Packets
- 긴 메시지 전환은 지연이 오래걸릴 뿐만 아니라 오류에 더 취약함
- 두 홉을 통해 1메가비트의 대용량 메시지를 전송하려고 한다고 가정
- 각 홉의 비트 오류율은 10^(-6)
- 메시지를 성공적으로 전달하기 위해 얼마나 많은 비트를 전송해야 하는가?
- 메시지를 전환하면 한번에 1메가비트 메시지가 전송됨
- 각 홉에서의 전송 성공 확률은 약 33%
- 따라서 평균적으로 홉당 약 3번의 전송이 필요
- 2 홉을 통해 전송되는 총 비트 수는 약 6메가비트
- 2번째 접근 방식에서는 1메가비트 메시지를 각각 100킬로비트의 작은 패킷 10개로 분할
- 각 패킷이 홉당 올바르게 도착할 확률은 약 90%
- 평균적으로 홉당 약 1.1개의 전송이 필요
- 2 홉을 통해 전송되는 총 비트 수가 2.2메가비트에 불과함
### Packet Switching - Datagram
- 패킷 스위칭에서 긴 메시지는 패킷 헤더의 소스 및 대상 주소 등 더 작은 패킷으로 분할됨
- 패킷은 독립적으로 라우팅되지만 패킷이 목적지에 순서가 맞지 않게 도착할 수 있으므로 연결이 필요 없음
- 모든 패킷을 네트워크로 파이프라인하면 지연을 줄이고 처리량을 늘릴 수 있음
- 인터랙티브 트래픽에는 지연 시간을 줄이는 것이 적합함
### Packet Switching Delay
- 3개의 패킷으로 분할된 메시지를 전송할 때 발생하는 최소 지연
- 3패킷이 동일한 경로를 따른다고 가정
- 메시지 스위칭과 공정하게 비교를 위해 패킷 스위칭에서 대기열 지연이 없고 오류 검사도 없는 것으로 가정
- 메시지 스위칭과 마찬가지로 각 링크마다 타우 전파 지연이 발생함
- 홉 3개로 인해 총 3개의 타우가 있으며 각 패킷은 메시지 크기의 1/3, 전송시간은 T/3
- 3개의 패킷이 소스에서 첫번째 패킷 스위치로 성공적으로 전송되고 첫번째 스위치에서 패킷1이 저장된 다음 스위치2로 전달되고,
- 패킷2는 소스에서 스위치2로 전송됨
- 이 패킷 파이프라이닝은 메시지 전달의 총 지연을 3타우에 5(T/3)으로 줄이며, 
- L 홉을 통한 k-패킷 메시지의 총 지연을 추가로 도출가능
- 패킷 스위칭으로는 전체 전파 지연을 줄일 수 없지만 패킷 파이프라이닝을 통해 패킷 전송 지연을 크게 줄일 수 있음
### 요약
- 패킷 크기가 작을수록 세부 수준이나 패킷 파이프라인이 더 세밀해지기 때문에 전체 지연이 줄어든다고 말할 수도 있음
- 실제로는 패킷 헤더 오버헤드와 다른 모든 오버헤드가 발생하여 최소 패킷 크기에 일정한 제약을 가함